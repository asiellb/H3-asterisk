#!/usr/bin/perl

use strict;
use warnings;
use Net::FTP;

sub fetcher {
	my ($remote, $LOCALDIR, $files) = @_;

	chdir $LOCALDIR;

	opendir(LDIR,$LOCALDIR) 
		or die "Cannot opendir $LOCALDIR: $!";
	my @locals = grep { /^[^\.]/ } readdir(LDIR);
	close LDIR;

	my $ftp = Net::FTP->new("ftp.telenational.net", Debug => 0)
		or die "Cannot connect: $@";

	$ftp->login("asiapacific",'Ap4c171c')
		or die "Cannot login ", $ftp->message;

	$ftp->pasv();
	$ftp->binary();

	$ftp->cwd($remote)
		or die "Cannot change working directory $remote ", $ftp->message;

	for my $ent (@$files) {
		if (grep { /$ent/ } @locals) {
			# print "already have $ent\n";
		} else {
			print "getting $ent\n";
			$ftp->get($ent) or die "get of $ent failed: ", $ftp->message;
		}
	}

	$ftp->quit();
}

# qwest
fetcher('/Agents/agents/asiapacific/CDR/Qwest/Monthly/20090407', '/home/grant/carrier-cdr/qwest/20090407',
	[
	'763_c67328520_a.zip',
	'763_c67328520_b.zip',
	'763_c67328520_c.zip',
	'763_c67328520_d.zip',
	'763_c67328520_e.zip',
	'763_c67328520_f.zip',
	'763_c67328520_g.zip',
	'763_c67328520_h.zip',
	'763_c67328520_i.zip',
	'763_c67328520_j.zip',
	'763_c67328520_k.zip',
	]);


# gblx
fetcher('/Agents/agents/asiapacific/CDR/GX', '/home/grant/carrier-cdr/gblx',
	[
	'0899584555_200901012759.zip',
	'0899584555_200901022760.zip',
	'0899584555_200901032761.zip',
	'0899584555_200901042762.zip',
	'0899584555_200901052763.zip',
	'0899584555_200901062764.zip',
	'0899584555_200901072765.zip',
	'0899584555_200901082766.zip',
	'0899584555_200901092767.zip',
	'0899584555_200901102768.zip',
	'0899584555_200901112769.zip',
	'0899584555_200901122770.zip',
	'0899584555_200901132771.zip',
	'0899584555_200901142772.zip',
	'0899584555_200901152773.zip',
	'0899584555_200901162774.zip',
	'0899584555_200901172775.zip',
	'0899584555_200901182776.zip',
	'0899584555_200901192777.zip',
	'0899584555_200901202778.zip',
	'0899584555_200901212779.zip',
	'0899584555_200901222780.zip',
	'0899584555_200901232781.zip',
	'0899584555_200901242782.zip',
	'0899584555_200901252783.zip',
	'0899584555_200901262784.zip',
	'0899584555_200901272785.zip',
	'0899584555_200901282786.zip',
	'0899584555_200901292787.zip',
	'0899584555_200901302788.zip',
	'0899584555_200901312789.zip',
	'0899584555_200902012790.zip',
	'0899584555_200902022791.zip',
	'0899584555_200902032792.zip',
	'0899584555_200902042793.zip',
	'0899584555_200902052794.zip',
	'0899584555_200902062795.zip',
	'0899584555_200902072796.zip',
	'0899584555_200902082797.zip',
	'0899584555_200902092798.zip',
	'0899584555_200902102799.zip',
	'0899584555_200902112800.zip',
	'0899584555_200902122801.zip',
	'0899584555_200902132802.zip',
	'0899584555_200902142803.zip',
	'0899584555_200902152804.zip',
	'0899584555_200902162805.zip',
	'0899584555_200902172806.zip',
	'0899584555_200902182807.zip',
	'0899584555_200902192808.zip',
	'0899584555_200902202809.zip',
	'0899584555_200902212810.zip',
	'0899584555_200902222811.zip',
	'0899584555_200902232812.zip',
	'0899584555_200902242813.zip',
	'0899584555_200902252814.zip',
	'0899584555_200902262815.zip',
	'0899584555_200902272816.zip',
	'0899584555_200902282817.zip',
	'0899584555_200903012818.zip',
	'0899584555_200903022819.zip',
	'0899584555_200903032820.zip',
	'0899584555_200903042821.zip',
	'0899584555_200903052822.zip',
	'0899584555_200903062823.zip',
	'0899584555_200903072824.zip',
	'0899584555_200903082825.zip',
	'0899584555_200903092826.zip',
	'0899584555_200903102827.zip',
	'0899584555_200903112828.zip',
	'0899584555_200903122829.zip',
	'0899584555_200903132830.zip',
	'0899584555_200903142831.zip',
	'0899584555_200903152832.zip',
	'0899584555_200903162833.zip',
	'0899584555_200903172834.zip',
	'0899584555_200903182835.zip',
	'0899584555_200903192836.zip',
	'0899584555_200903202837.zip',
	'0899584555_200903212838.zip',
	'0899584555_200903222839.zip',
	'0899584555_200903232840.zip',
	'0899584555_200903242841.zip',
	'0899584555_200903252842.zip',
	'0899584555_200903262843.zip',
	'0899584555_200903272844.zip',
	'0899584555_200903282845.zip',
	'0899584555_200903292846.zip',
	'0899584555_200903302847.zip',
	'0899584555_200903312848.zip',
	'0899584555_200904012849.zip',
	'0899584555_200904022850.zip',
	'0899584555_200904032851.zip',
	'0899584555_200904042852.zip',
	'0899584555_200904052853.zip',
	'0899584555_200904062854.zip',
	'0899584555_200904072855.zip',
	'0899584555_200904082856.zip',
	'0899584555_200904092857.zip',
	'0899584555_200904102858.zip',
	'0899584555_200904112859.zip',
	'0899584555_200904122860.zip',
	'0899584555_200904132861.zip',
	'0899584555_200904142862.zip',
	'0899584555_200904152863.zip',
	'0899584555_200904162864.zip',
	'0899584555_200904172865.zip',
	'0899584555_200904182866.zip',
	'0899584555_200904192867.zip',
	'0899584555_200904202868.zip',
	'0899584555_200904212869.zip',
	'0899584555_200904222870.zip',
	'0899584555_200904232871.zip',
	'0899584555_200904242872.zip',
	'0899584555_200904252873.zip',
	'0899584555_200904262874.zip',
	'0899584555_200904272875.zip',
	'0899584555_200904282876.zip',
	'0899584555_200904292877.zip',
	'0899584555_200904302878.zip',
	'0899584555_200905012879.zip',
	'0899584555_200905022880.zip',
	'0899584555_200905032881.zip',
	'0899584555_200905042882.zip',
	'0899584555_200905052883.zip',
	'0899584555_200905062884.zip',
	'0899584555_200905072885.zip',
	'0899584555_200905082886.zip',
	'0899584555_200905092887.zip',
	'0899584555_200905102888.zip',
	'0899584555_200905112889.zip',
	'0899584555_200905122890.zip',
	'0899584555_200905132891.zip',
	'0899584555_200905142892.zip',
	'0899584555_200905152893.zip',
	'0899584555_200905162894.zip',
	'0899584555_200905172895.zip',
	'0899584555_200905182896.zip',
	'0899584555_200905192897.zip',
	'0899584555_200905202898.zip',
	'0899584555_200905212899.zip',
	'0899584555_200905222900.zip',
	'0899584555_200905232901.zip',
	'0899584555_200905242902.zip',
	'0899584555_200905252903.zip',
	'0899584555_200905262904.zip',
	'0899584555_200905272905.zip',
	'0899584555_200905282906.zip',
	'0899584555_200905292907.zip',
	'0899584555_200905302908.zip',
	'0899584555_200905312909.zip',
	'0899584555_200906012910.zip',
	'0899584555_200906022911.zip',
	'0899584555_200906032912.zip',
	'0899584555_200906042913.zip',
	'0899584555_200906052914.zip',
	'0899584555_200906062915.zip',
	'0899584555_200906072916.zip',
	'0899584555_200906082917.zip',
	'0899584555_200906092918.zip',
	'0899584555_200906102919.zip',
	'0899584555_200906112920.zip',
	'0899584555_200906122921.zip',
	'0899584555_200906132922.zip',
	'0899584555_200906142923.zip',
	'0899584555_200906152924.zip',
	'0899584555_200906162925.zip',
	'0899584555_200906172926.zip',
	'0899584555_200906182927.zip',
	'0899584555_200906192928.zip',
	'0899584555_200906202929.zip',
	'0899584555_200906212930.zip',
	'0899584555_200906222931.zip',
	'0899584555_200906232932.zip',
	'0899584555_200906242933.zip',
	'0899584555_200906252934.zip',
	'0899584555_200906262935.zip',
	'0899584555_200906272936.zip',
	'0899584555_200906282937.zip',
	'0899584555_200906292938.zip',
	'0899584555_200906302939.zip',
	'0899584555_200907012940.zip',
	'0899584555_200907022941.zip',
	'0899584555_200907032942.zip',
	'0899584555_200907042943.zip',
	'0899584555_200907052944.zip',
	'0899584555_200907062945.zip',
	'0899584555_200907072946.zip',
	'0899584555_200907082947.zip',
	'0899584555_200907092948.zip',
	'0899584555_200907102949.zip',
	'0899584555_200907112950.zip',
	'0899584555_200907122951.zip',
	'0899584555_200907132952.zip',
	'0899584555_200907142953.zip',
	'0899584555_200907152954.zip',
	'0899584555_200907162955.zip',
	'0899584555_200907172956.zip',
	'0899584555_200907182957.zip',
	'0899584555_200907192958.zip',
	'0899584555_200907202959.zip',
	'0899584555_200907212960.zip',
	'0899584555_200907222961.zip',
	'0899584555_200907232962.zip',
	'0899584555_200907242963.zip',
	'0899584555_200907252964.zip',
	'0899584555_200907262965.zip',
	'0899584555_200907272966.zip',
	'0899584555_200907282967.zip',
	'0899584555_200907292968.zip',
	'0899584555_200907302969.zip',
	'0899584555_200907312970.zip',
	'0899584555_200908012971.zip',
	'0899584555_200908022972.zip',
	'0899584555_200908032973.zip',
	'0899584555_200908042974.zip',
	'0899584555_200908052975.zip',
	'0899584555_200908062976.zip',
	'0899584555_200908072977.zip',
	'0899584555_200908082978.zip',
	'0899584555_200908092979.zip',
	'0899584555_200908102980.zip',
	'0899584555_200908112981.zip',
	'0899584555_200908122982.zip'
	]);

